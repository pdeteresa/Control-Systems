% define state space A,B,C,D
clear;clc;
Kp = -2700;Ki = -1900;Kd = -50;
g = tf(-24.379,[1 52.93 -0.047 -32249]);
num = -24.379*[Kp Kd Ki];
den = [1 52.9358 -24.378*Kd -(32255+24.378*Kp) -24.378*Ki];
[a,b,c,d]=tf2ss(num,den);
s = ss(a,b,c,d);
Mc = ctrb(a,b);
Mo = obsv(a,c);
W = [1,52.9358000000001,1218.90000000000,33565.6000000000;
    0,1,52.9358000000001,1218.90000000000;
0,0,1,52.9358000000001;
0,0,0,1]; % w matrix
T = Mc*W;
a_bar = inv(T)*a*T;
b_bar = inv(T)*b;
a_vec = [52.9358000000001,1218.90000000000,33565.6000000000,1218.90000000000];
ac_vec = [-36056.3358000000,85217805.6717200,-54279173612.7977,2639854858819.44];
K_T = ac_vec-a_vec;
q = a_bar-b_bar*K_T

Kp = -3000;
Ki = -1500;
Kd = -175;
pid_control = pid(-3000,-1400,-110);
g2 = feedback(g*pid_control,1);
g_pf = tf([0.1 1],[1 1]);
g3 = g_pf+g2;%step(g3);
pid2 = Kp+Ki.*tf([0 1],[1 0])+Kd.*tf([1 0],[0 1]);
g22 = feedback(g.*pid2,1);
g33 = g_pf+g22;step(g33);